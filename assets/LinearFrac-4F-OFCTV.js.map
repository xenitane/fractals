{"version":3,"file":"LinearFrac-4F-OFCTV.js","sources":["../../src/lib/utils/renderer/Linear.ts","../../src/pages/LinearFrac.tsx"],"sourcesContent":["import { LinearFractalOptions, Point } from \"@/types\";\nimport { rounder } from \"@/lib/utils/complex\";\nimport { createSVGPathLineElement } from \"@/lib/utils/svgPathGen\";\n\nexport function LinearRenderer(\n\tSVGRef: SVGSVGElement,\n\t{ animate, colored, order, FractalInfo, interval }: LinearFractalOptions\n) {\n\tlet cursor: Point = [0, 0];\n\tlet direction: Point = [1, 0];\n\tconst points: Point[] = [[0, 0]];\n\tconst bounds: [Point, Point] = [\n\t\t[0, 0],\n\t\t[0, 0],\n\t];\n\n\t(function build(n: number, symbol: string) {\n\t\tif (FractalInfo.rules[symbol][0] || n === 0) {\n\t\t\t[cursor, direction] = FractalInfo.rules[symbol][1](cursor, direction);\n\t\t\tif (cursor[0] !== points.at(-1)![0] || cursor[1] !== points.at(-1)![1]) points.push(cursor);\n\t\t\tbounds[0][0] = Math.min(bounds[0][0], cursor[0]);\n\t\t\tbounds[0][1] = Math.min(bounds[0][1], cursor[1]);\n\t\t\tbounds[1][0] = Math.max(bounds[1][0], cursor[0]);\n\t\t\tbounds[1][1] = Math.max(bounds[1][1], cursor[1]);\n\t\t} else {\n\t\t\tfor (let i = 0; i < FractalInfo.rules[symbol][2]!.length; i++)\n\t\t\t\tbuild(n - 1, FractalInfo.rules[symbol][2]!.charAt(i));\n\t\t}\n\t})(order + FractalInfo.shift, \"I\");\n\tconst origin: Point = [(bounds[1][0] + bounds[0][0]) / 2, (bounds[1][1] + bounds[0][1]) / 2];\n\tconst scale: number = 1800 / Math.max(bounds[1][0] - bounds[0][0], bounds[1][1] - bounds[0][1]);\n\tfor (const point of points) {\n\t\tpoint[0] = rounder((point[0] - origin[0]) * scale);\n\t\tpoint[1] = rounder((point[1] - origin[1]) * scale);\n\t}\n\n\tif (colored) {\n\t\t// Todo: fill color\n\t}\n\tif (animate) {\n\t\tlet i = 1;\n\t\tinterval.i = setInterval(() => {\n\t\t\tif (i === points.length) {\n\t\t\t\tclearInterval(interval.i);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tSVGRef.appendChild(\n\t\t\t\tcreateSVGPathLineElement({\n\t\t\t\t\tcolor: [0, 0, 0],\n\t\t\t\t\tstart: points[i - 1],\n\t\t\t\t\tend: points[i],\n\t\t\t\t})\n\t\t\t);\n\t\t\ti++;\n\t\t}, 5);\n\t} else {\n\t\tfor (let i = 1; i < points.length; i++)\n\t\t\tSVGRef.appendChild(\n\t\t\t\tcreateSVGPathLineElement({\n\t\t\t\t\tcolor: [0, 0, 0],\n\t\t\t\t\tstart: points[i - 1],\n\t\t\t\t\tend: points[i],\n\t\t\t\t})\n\t\t\t);\n\t}\n}\n","import { useRef } from \"react\";\nimport { LinearRenderer, cn } from \"@/lib/utils\";\nimport { useParams, Navigate } from \"react-router-dom\";\nimport FractalForm, { formSchema } from \"@/components/FractalForm\";\nimport LinearFractalRulesSet from \"@/lib/rules/Linear\";\nimport SVGCanvas from \"@/components/SVGCanvas\";\n\nconst LinearFrac = () => {\n\tconst { fracID } = useParams();\n\tconst SVGRef = useRef<SVGSVGElement>(null);\n\n\tif (!(fracID! in LinearFractalRulesSet)) return <Navigate to=\"/geo-vis/404\" />;\n\n\tconst interval: { i?: NodeJS.Timeout } = { i: undefined };\n\n\tlet FractalInfo = LinearFractalRulesSet[fracID!].rules();\n\n\tfunction SVGReset() {\n\t\tFractalInfo = LinearFractalRulesSet[fracID!].rules();\n\t\tSVGRef.current!.innerHTML = \"\";\n\t\tclearInterval(interval.i);\n\t\tinterval.i = undefined;\n\t}\n\n\tfunction handleSubmit(data: formSchema) {\n\t\tSVGReset();\n\t\tLinearRenderer(SVGRef.current!, {\n\t\t\t...data,\n\t\t\tinterval,\n\t\t\tFractalInfo,\n\t\t});\n\t}\n\n\tfunction handleSave() {\n\t\t// console.log(SVGRef.current);\n\t}\n\n\treturn (\n\t\t<article className={cn(\"flex w-full flex-col gap-8 py-2\", \"lg:flex-row\")}>\n\t\t\t<div className={cn(\"flex w-full flex-col\", \"lg:w-1/3\")}>\n\t\t\t\t<h3 className={cn(\"pb-4 text-2xl underline\", \"lg:text-3xl\")}>{LinearFractalRulesSet[fracID!].name}</h3>\n\t\t\t\t<FractalForm\n\t\t\t\t\thandleSubmit={handleSubmit}\n\t\t\t\t\tSVGReset={SVGReset}\n\t\t\t\t\tmaxOrder={LinearFractalRulesSet[fracID!].maxOrder}\n\t\t\t\t\thandleSave={handleSave}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className={cn(\"flex justify-center\", \"lg:w-2/3\")}>\n\t\t\t\t<div className={cn(\"aspect-square w-full rounded-xl bg-neutral-200\", \"lg:w-[80vh]\")}>\n\t\t\t\t\t<SVGCanvas ref={SVGRef} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</article>\n\t);\n};\n\nexport default LinearFrac;\n"],"names":["LinearRenderer","SVGRef","animate","colored","order","FractalInfo","interval","cursor","direction","points","bounds","build","n","symbol","i","origin","scale","point","rounder","createSVGPathLineElement","LinearFrac","fracID","useParams","useRef","LinearFractalRulesSet","jsx","Navigate","SVGReset","handleSubmit","data","handleSave","cn","jsxs","FractalForm","SVGCanvas"],"mappings":"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"}