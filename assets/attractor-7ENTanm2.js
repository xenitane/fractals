import{a as g,j as e,b as m,k as N,B as j,c as A,R as q,G as D,r as H}from"./GlobalLayout-o9Xx0qgO.js";import{m as b,g as w,u as B,F as G,a as y,b as v,c as R,d as M,I as F,e as V,f as E,z as p,t as _}from"./form-vfEzKw6_.js";import{E as $}from"./Error-6vwtpaSV.js";function z(s,{order:r,animate:l,AttractorInfo:a,interval:o}){const u=Math.pow(10,r),f=a.scale,x=a.shift,i=a.origins.length;if(l){const t=Array.from({length:i},(n,d)=>Array.from({length:u},()=>[a.origins[d][0],a.origins[d][1]]));t.forEach(n=>n.forEach(d=>{const[h,L]=b(w(d,x),f);s.fillRect(h-1,999-L,2,2)}));let c=0;o.i=setInterval(()=>{for(let n=0;n<i;n++){const[d,h]=t[n][c+1];s.clearRect(d+999,999-h,2,2),t[n][(c+1)%u]=a.rules(t[n][c])}c=(c+1)%u;for(let n=0;n<i;n++){const[d,h]=b(w(t[n][c],x),f);if(isNaN(d)||isNaN(h))throw new Error("wtf");s.fillRect(d-1,999-h,2,2)}},1)}else{const t=a.origins;for(let c=0;c<Math.pow(10,r);c++)for(let n=0;n<i;n++){const[d,h]=b(w(t[n],x),f);if(isNaN(d)||isNaN(h))throw new Error("wtf");s.fillRect(d+999,999-h,2,2),t[n]=a.rules(t[n])}}}function I(s,r){const l={order:p.coerce.number().min(0,{message:"should be greater than or equal to 0"}).max(s,{message:`should be less than or equal to ${s}`}).int({message:"Must be an Integer Value"})};for(const a of r)l[a[0]]=p.coerce.number().finite();return p.object(l)}const T=g.forwardRef(({handleSubmit:s,DrawableReset:r,handleSave:l,maxOrder:a,symbols:o},u)=>{const f={order:a};for(const t of o)f[t[0]]=t[1];const x=I(a,o),i=B({resolver:_(x),defaultValues:f});return e.jsx(G,{...i,children:e.jsxs("form",{className:"w-full",onSubmit:t=>void i.handleSubmit(s)(t),onReset:()=>{r(),i.reset()},children:[e.jsxs("div",{children:[e.jsx(y,{control:i.control,name:"order",render:({field:t})=>e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(R,{className:m("w-1/3 text-base","lg:text-lg"),children:"Depth"}),e.jsx(M,{className:"w-11",children:e.jsx(F,{type:"number",className:"h-6 p-2 text-center",...t})})]}),e.jsxs(V,{children:["The iterative depth for the fractal",e.jsx("br",{}),"Must be between 0 and",` ${a}`]}),e.jsx(E,{})]})}),o.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(N,{className:m("my-2 bg-neutral-950","dark:bg-neutral-50")}),e.jsx("div",{className:m("text-xl","lg:text-2xl"),children:"Attractor Paramerters"}),e.jsx("div",{className:"grid grid-cols-2 gap-x-10 gap-y-2",children:o.map(([t])=>e.jsx(y,{control:i.control,name:t,render:({field:c})=>e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(R,{className:m("w-1/3 text-base","lg:text-lg"),children:t}),e.jsx(M,{className:"w-2/3",children:e.jsx(F,{type:"number",className:"h-6 p-2 text-center",...c})})]}),e.jsx(E,{})]})},t))}),e.jsx("p",{className:"text-sm font-medium text-red-500 dark:text-red-900",ref:u}),e.jsx(N,{className:m("my-2 bg-neutral-950","dark:bg-neutral-50")})]})]}),e.jsxs("div",{className:"flex w-full justify-between pt-4",children:[e.jsx(j,{type:"submit",className:m("w-1/4 rounded-md"),children:"Draw"}),e.jsx(j,{type:"reset",className:m("w-1/4 rounded-md"),children:"Reset"}),e.jsx(j,{type:"button",className:m("w-1/4 rounded-md"),onClick:l,disabled:!0,children:"Save"})]})]})})});T.displayName="AttractorForm";const O={name:"Tinker Bell Attractor",maxOrder:5,symbolNames:[["a",.9],["b",-.6013],["c",2],["d",.5]],rules:s=>({origins:[[-Math.random(),-Math.random()]],scale:[600,0],shift:[.5,.5],rules:([r,l])=>{const a=r*r-l*l+s.a*r+s.b*l,o=2*r*l+s.c*r+s.d*l;return[a,o]}})},Q={name:"Gingerbread Man",maxOrder:3,symbolNames:[],rules:()=>({origins:Array.from({length:100},()=>[Math.random()*5,Math.random()*5]),scale:[-120*Math.SQRT1_2,-120*Math.SQRT1_2],shift:[-3,-3],rules:([s,r])=>[1-r+Math.abs(s),s]})},S={"gingerbread-man":Q,"tinker-bell":O},k=g.forwardRef((s,r)=>e.jsx("canvas",{style:{height:"100%",width:"100%"},ref:r}));k.displayName="HTMLCanvas";const W=()=>{var i,t;const s=(t=(i=window.location.search.split("?").at(1))==null?void 0:i.split("&").filter(c=>c.startsWith("id=")).at(0))==null?void 0:t.split("=").at(1),r=g.useRef(null),l=g.useRef(null);if(g.useEffect(()=>{r.current.height=2e3,r.current.width=2e3},[]),s===void 0||!(s in S))return window.location.href="/geo-vis/404",e.jsx($,{});const a={i:void 0},o=S[s];function u(){r.current.innerHTML="",r.current.getContext("2d").clearRect(0,0,2e3,2e3),clearInterval(a.i),a.i=void 0,l.current&&(l.current.innerHTML="")}function f({order:c,...n}){u();try{z(r.current.getContext("2d"),{order:c,animate:!1,interval:a,colored:!1,AttractorInfo:o.rules(n)})}catch{u(),l.current&&(l.current.innerHTML="Some Error has occured while calculating, try with different parameters")}}function x(){}return e.jsxs("article",{className:m("flex w-full flex-col gap-8 py-2","lg:flex-row"),children:[e.jsxs("div",{className:m("flex w-full flex-col","lg:w-1/3"),children:[e.jsx("h3",{className:m("pb-4 text-2xl underline","lg:text-3xl"),children:o.name}),e.jsx(T,{handleSubmit:f,DrawableReset:u,maxOrder:o.maxOrder,handleSave:x,symbols:o.symbolNames,ref:l})]}),e.jsx("div",{className:m("flex justify-center","lg:w-2/3"),children:e.jsx("div",{className:m("aspect-square w-full rounded-xl bg-slate-200","lg:w-[80vh]"),children:e.jsx(k,{ref:r})})})]})};A.createRoot(document.querySelector("#root")).render(e.jsx(q.StrictMode,{children:e.jsx(D,{children:e.jsx(W,{})})}));H(console.log);
